<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Text?>

<BorderPane xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.lms.lmsfinal.AdminDashboardController"
            prefWidth="1200.0" prefHeight="760.0"
            styleClass="scene-root theme-dark">

    <top>
        <HBox spacing="12" styleClass="topbar">
            <padding><Insets top="16" right="24" bottom="16" left="24"/></padding>
            <Text text="Admin Dashboard" styleClass="title-lg"/>
            <Pane HBox.hgrow="ALWAYS"/>
            <Label fx:id="userLabel" textFill="white"/>
            <Button text="Logout" onAction="#onLogout" styleClass="btn-pill"/>
        </HBox>
    </top>

    <center>
        <HBox spacing="16">
            <padding><Insets top="16" right="16" bottom="16" left="16"/></padding>

            <!-- BOOKS (read-only preview + manage button) -->
            <VBox spacing="10" HBox.hgrow="ALWAYS">
                <Label text="Books" styleClass="title-md"/>

                <HBox spacing="8">
                    <TextField fx:id="searchField"
                               promptText="Search title / author / ISBN"
                               HBox.hgrow="ALWAYS"/>
                    <Button text="Search" onAction="#onSearchBooks" styleClass="btn-chip"/>
                    <Button text="Reset"  onAction="#onResetBooks" styleClass="btn-chip"/>
                </HBox>

                <TableView fx:id="booksTable" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn fx:id="colIsbn"      text="ISBN"      prefWidth="140"/>
                        <TableColumn fx:id="colTitle"     text="Title"     prefWidth="260"/>
                        <TableColumn fx:id="colAuthor"    text="Author"    prefWidth="200"/>
                        <TableColumn fx:id="colPublisher" text="Publisher" prefWidth="180"/>
                        <TableColumn fx:id="colTotal"     text="Total"     prefWidth="70"/>
                        <TableColumn fx:id="colAvail"     text="Available" prefWidth="90"/>
                    </columns>
                </TableView>

                <!-- Single button to go to full book management screen -->
                <Button text="Manage Books"
                        onAction="#openManageBooks"
                        styleClass="btn-primary"/>

                <Label fx:id="statusBooks" textFill="white"/>
            </VBox>

            <!-- BORROWS -->
            <VBox spacing="10" prefWidth="460">
                <Label text="Active Borrows" styleClass="title-md"/>

                <TableView fx:id="borrowsTable" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn fx:id="bColName"  text="Student" prefWidth="140"/>
                        <TableColumn fx:id="bColEmail" text="Email"   prefWidth="180"/>
                        <TableColumn fx:id="bColIsbn"  text="ISBN"    prefWidth="110"/>
                        <TableColumn fx:id="bColTitle" text="Title"   prefWidth="240"/>
                        <TableColumn fx:id="bColDue"   text="Due"     prefWidth="100"/>
                        <TableColumn fx:id="bColOver"  text="Overdue" prefWidth="90"/>
                    </columns>
                </TableView>

                <HBox spacing="8">
                    <Button text="Refresh"       onAction="#refreshBorrows" styleClass="btn-chip"/>
                    <Button text="Mark Returned" onAction="#markReturned"   styleClass="btn-danger"/>
                </HBox>

                <Label fx:id="statusBorrows" textFill="white"/>
            </VBox>

        </HBox>
    </center>
</BorderPane>
